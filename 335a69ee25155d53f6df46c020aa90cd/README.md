# Malware Analysis Report N°3


**Date**: 25/02/2021

**Author/s**: Finch


  * [Key observation](#key-observation)
  * [Indicators of compromise](#indicators-of-compromise)
  * [Delivery method](#delivery-method)
- [Sample identification](#sample-identification)
  * [File name, type, size](#file-name-type-size)
  * [File hashes](#file-hashes)
  * [Anti-virus indentifiers](#anti-virus-indentifiers)
- [Dependencies](#dependencies)
  * [Supported OS](#supported-os)
  * [Required libraries](#required-libraries)
  * [Configuration files](#configuration-files)
  * [Scripts and Executables](#scripts-and-executables)
  * [Network traffic](#network-traffic)
- [Sample identification](#sample-identification)
  * [Infection capabilities](#infection-capabilities)
  * [Self-preservation capacity](#self-preservation-capacity)
  * [Data leakage abilities](#data-leakage-abilities)
  * [Remote attacker interactions](#remote-attacker-interactions)
- [Observations](#observations)
  * [Behavioral analysis](#behavioral-analysis)
  * [Code analysis](#code-analysis)
  * [Dynamic code analysis](#dynamic-code-analysis)
  * [Memory analysis](#memory-analysis)
- [Supporting figures](#supporting-figures)
  * [Logs](#logs)
  * [Strings](#strings)
  * [Function listings](#function-listings)
  * [Screenshots](#screenshots)
  * [Additional comments](#additional-comments)

# Summary of the analysis

## Key observation
The sample try to compromise the analysis by looking as a benign executable.
3 Layers of protection.
## Indicators of compromise

Drop `Results.txt` in `(Special.Directories.MyDocuments)`

Drop `Clipboard.txt` in `Special.Directories.MyDocuments`

Drop `Leyboardlogs.txt` in `Special.Directories.MyDocuments`

Drop `A+(Random())` in `Special.Directories.MyDocuments` -> Every .txt contains Clipboard Logs, Passwords, Keyboard Logs.


## Delivery method

The delivery is made by email

Email example(Thanks to [abuse_ch](https://bazaar.abuse.ch/user/41587972/)):

Malspam distributing 404Keylogger:

**From**: sirlopu.hector@grupoproyectos.com.pe

**Subject**: Request Information Form Enquiry

**Attachment**: HI2003-02.arj (contains "HI2003-02.exe")


# Sample identification
## File name, type, size

**File name**: HI2003-02.exe

**Type**: .NET

**Size**: 366KB (375,296 bytes)

**Size on disk**: 368KB (376,832 bytes)

**TargetFramework**:  .NETFramework,Version=v4.0

**Assembly title**: Table Adapter

**Assembly company**: 

**Assembly product**: Table Adapter

**Guid**: 86195057-b3a6-4468-9e06-fbda09a53e5

## File hashes
[First Layer]

**MD5**: 335a69ee25155d53f6df46c020aa90cd

**SHA1**: cbecea1d93ff376b6a7f5ea72c191d4020372344

**SHA256**: 66dd2c7ac2b0bc7b604efa99f21a828da26c15a366a2e809e23b82dda44b63dd

**SHA3-384**: 7acef3a7f5e316b666d352a9b61b940e16fa7145a99f66c7a325d22aca4825adcb289f2d6a42c2a921983afce21ac19e

**VHASH**: 235036751514b072bbbe14cd1

**AUTHENTIHASH**: 1c3331aa409e6c766e1fb7f731726be7709affa0bc738fc0413414429b589760

**IMPHASH**: f34d5f2d4577ed6d9ceec516c1f5a744

**SSDEEP**: 6144:5lAsmm9PRXvDUtDCpewbzTwrp41W386OvsDfYt7Yt6AECul1CRtA3I/mqV7Uw86w:5l1VvAOYwbY4ksDWY2t2lf3I/mqVc6eF

**TLSH**: T15784CF40229CD10CE1BB773996B061EF57F97E21D613D61F9A843A6F2C73A428F1136A

**human-hash**: carpet-sodium-charlie-timing

[Last Layer - 404 Keylogger]

**MD5**: 770cc582d1d8f337f194c3cbbbd7cab2

**SHA1**: a545082ea3b2600d1e5559a140e63b4f0cd5849d

**SHA256**: 116ec927d44188d785b956cf26405a388a9fa35820f4ea2a783e6d739e22afe0

**VHASH**: 215036551511800f4b2e3320

**AUTHENTIHASH**: f4b231d50b22a0e96d9fbb44372c5cf6d1a652c78fca1e98d3e990bacd92755e

**IMPHASH**: f34d5f2d4577ed6d9ceec516c1f5a744

**SSDEEP**: 1536:11gb/gS6NWYGQgC/k/ziH9MGeckCE3k+nOXn9MqtpjpiOMYF:fgb/y8YGQg00e9YcbE3kD9MqtLGYF

**TLSH**: T177B3B58C37D49560E2EE47B085F2432482B9D497A927DE0F04C619FA5B7F342894EED7

## Anti-virus indentifiers
- 404 Keylogger


# Dependencies

## Supported OS

.NET [The target is Windows]

## Required libraries

.NET

## Configuration files

None

## Scripts and Executables

## Network traffic

**DNS**: checkip.dyndns.org -> **GET REQUEST**: http://checkip.dyndns.org/


# Sample identification
## Infection capabilities
Stealer, Keylogger

## Self-preservation capacity
Tries to detect virtual machine.

Reversed strings to avoid detection.

Tries to detect antivirus / analysis enviorement:
`['zlclient', 'egui", "bdagent", "npfmsg:, "olydbg', "anubis", "wireshark" 
avastui", "_Avp32", vsmon", "mbam", "keyscrambler "_Avpcc", "_Avpm", "Ackwin32", "outpost", "Anti-Trojan' "ANTIVIR", "Apvxdwin", "ATRACK", "Autodown", "Avconsol", "Ave32", "AV ctrl", "Avkserv", "Avnt", "Avp", "Avp32", "AVpcc", "Avpdos32", "Avpm", "Avptc32", "Avpupd", "Avsched32", "AVSYNMGR", "Avwin95", "Avwupd32", "Blackd", "Blackice", "cfiadmin", "cfiaudit", "Cfinet", "Cfinet32", "claw95", "claw95cf", "cleaner", "cleaner3", 'Defwatch', 'Dvp95', 'Dvp95_0', 'Ecengine', 'Esafe', 'Espwatch', 'F-Agnt95', 'Findviru', 'Fprot', 'F-Prot', 'F-Prot95', 'Fp-win', 'Frw', 'F-Stopw', 'Iamapp', 'Iamserv', 'ibmasn', 'ibmaysp', 'Icload95', 'icloadnt', 'icmon', 'Icsupp95', 'Icsuppnt', 'Iface, 'Iomon98', 'Jedi', 'Lockdown2000', 'Lookout', 'Luall', 'MCAFEE', 'Moolive', 'Mpftray', 'N32scanw', 'NAVAPSVC', 'NAVAPW32', 'NAVLU32', 'Navnt', 'NAVRUNR', 'Navw32', 'Navwnt', 'NeoWatch', 'NISSERV', 'Nisum', 'Nmain', 'Normist', 'NORTON', 'Nupgrade', 'Nvc95', 'outpost', 'Padmin', 'Pavc1', 'Paysched', 'Pavw',7 'PcciombN', 'PCCMAIN', 'Pccwin98', 'Pcfwallicon', 'Persfw', 'POP3TRAP', 'PviEw95', 'Rav7', 'Rav7win', 'Rescue', 'safeweb', 'Scan32', 'scan95', 'scanpm', 'scrscan', 'Serv95', 'Smc', 'SMCSERVICE', 'Snort', 'Sphinx', 'Sweep95', 'SYMPROXYSVC', 'Tbscan', 'Tca', 'Tds2-98', 'Tds2-Nt', 'TermiNET', 'vet95', 'Vettray', 'vscan40', 'vsecomr', 'vshwin32', 'vsstat', 'webscanx', 'wEBTRAP', 'wfindv32', 'Zonealarm', 'LOCKDOWN2000', 'RESCUE32', 'LUCOMSERVER', avgcc , 'avgcc', 'avgamsvr', 'avgupsvc', 'avgw , 'avgcc32', 'avgserv'k 'avgserv9 , 'avgserv9schedapp', 'avgemc', 'ashwebsv', 'ashdisp', 'ashmaisv', 'ashserv', 'aswupdsv', 'symwsc', 'norton', 'Norton Auto-Protect', 'norton_av', 'nortonav', 'ccsetmgr', 'ccevtmgr', 'avadmin', 'avcenter', 'avgnt', 'avguard', 'avnotify', ayscan • guardgui , • nod32krn', 'nod32kui', 'clamscan', 'clamTra,,/' 'clamwin', 'freshclam', 'oladdin', 'sigtool', 'w9xpopen', 'wclose', cmgrdian', 'alogserv', mcshield', 'vshwin32', 'avconsol', 'vsstat', 'aysynmgr , 'avcmd', 'avconfig', 'licmgr', 'sched' 'preupd', 'msmpEng', 'MSASCUl', 'Avira.systray']`


## Data leakage abilities

**GET IP**: From `'http://checkip.dydns.org'`

**Steal browsers / programs credential**: `['Mozilla Thunderbird', 'Mozilla Firefox', 'Chrome', 'SeaMonkey', 'IceDragon', 'CyberFox', 'Pale Moon', 'Xvast', 'Chedot', 'SuperBird', '360Browser', '360Chrome', 'Comodo', 'BraveSoftware', 'Torch', 'UCBrowser', 'Blisk', 'Epic Privacy Browser', 'FileZilla', 'Foxmail', 'Pidgin, 'Liebao', 'AVAST', 'Outlook', 'Windows Messaging Subsystem', 'FileZilla', 'QQBrowser' 'Orbitum', 'CocCoc', 'Slimjet', 'Tridium', 'Vivaldi', 'Chromium', 'GhostBrowser', 'CentBrowser', 'SuperBird', 'UCBrowser', 'Blisk']`

**Reversed Strings**: `['\\Opera Software\\Opera Stable\\Login Data', 'Opera\\Opera\\profile\\wand.dat', 'logins', 'origin_url', 'username_value', 'password_value']`

## Remote attacker interactions

**SMTP**: Host: `'mail.sapgroup.com.pk'` Port: `'587'` Email: `'moin.ansari@sapgroup.com.pk'` Password: `'moin@26919'`

# Observations
## Behavioral analysis
3 Layers of unpacking.

## Code analysis
Some methods are disabled, is obviously based on an automatic packer, in this case also the persistence is disabled.

The method with the role of taking the screenshot (in this case disabled) if abilitated drop the screenshot in: `'(SpecialDirectories.MyDocuments)\\404k\\Screenshot.png'`

## Dynamic Code Analysis

## Memory analysis
None


# Supporting figures
## Logs
## Strings
## Function listings

## Screenshots


## Additional comments

