# IDA DeGobfuscate Plugin

## How To Use

Before opening IDA, please edit **hexrays.cfg** and change the value of **DEFAULT_RADIX** to **16**

```
// Default constant radix
DEFAULT_RADIX           = 16
```

## How it works

I tried different ways to make this plugin work, due to the different ways Gobfuscate loads the encrypted strings, I developed this quick and a bit dirty plugin
to get at least an overview of the sample's capabilities.

Using the decompiler output and a regex, the plugin parses the encrypted string and key and performs the XOR.

Please note, some strings may be:

incorrect/incomplete (This happens because the encrypted string may be loaded in two different ways or entirely from the data sections <- In this case the string and key are not visible in the decompiler output, hence the plugin won't work. See the third screenshot)

![image](https://user-images.githubusercontent.com/52568048/154512010-34805fe7-31d1-4596-8112-48a8b2944888.png)

values from functions not related to Gobfuscate may be taken and showed as strings (This happens because the plugin iterates all the functions having the string "func" in the name)

![image](https://user-images.githubusercontent.com/52568048/154511862-dae8da7a-8cb6-42d9-8d1f-9d0a5a4ff5ae.png)


Some strings may have repeated letters, like this one:

![image](https://user-images.githubusercontent.com/52568048/154512474-64cb0f66-7eac-4dc6-987c-6f0bb2f0e97a.png)

## A few examples of how Gobfuscate loads the encrypted strings

![image](https://user-images.githubusercontent.com/52568048/154513716-bff719d5-6888-4ee8-a574-bf184ee200a3.png)

![image](https://user-images.githubusercontent.com/52568048/154513844-a0b56602-a3cb-434a-9fe2-d35e210008cc.png)

![image](https://user-images.githubusercontent.com/52568048/154520151-0c35407d-395e-4008-a7a2-3143ae03cbc5.png)


and many more..

If you improve the plugin and publish the improved version, please mention this repository.
